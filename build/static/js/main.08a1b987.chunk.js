(this["webpackJsonpdiscord-clone"]=this["webpackJsonpdiscord-clone"]||[]).push([[0],{103:function(e,a,n){},104:function(e,a,n){},105:function(e,a,n){},106:function(e,a,n){},107:function(e,a,n){},108:function(e,a,n){},109:function(e,a,n){"use strict";n.r(a);var s=n(3),t=n(2),c=n.n(t),r=n(25),i=n.n(r),l=(n(78),n(21)),o=(n(79),n(9)),d=n(29),j=Object(d.b)({name:"user",initialState:{user:null},reducers:{login:function(e,a){e.user=a.payload},logout:function(e){e.user=null}}}),u=j.actions,m=u.login,b=u.logout,h=function(e){return e.user.user},p=j.reducer,O=(n(83),Object(d.b)({name:"app",initialState:{serverId:null,serverName:null,channelId:null,channelName:null},reducers:{setServerInfo:function(e,a){e.serverId=a.payload.serverId,e.serverName=a.payload.serverName,e.channelId=null,e.channelName=null},setChannelInfo:function(e,a){e.channelId=a.payload.channelId,e.channelName=a.payload.channelName}}})),f=O.actions,v=f.setServerInfo,x=f.setChannelInfo,g=function(e){return e.app.serverId},_=function(e){return e.app.serverName},N=function(e){return e.app.channelId},y=function(e){return e.app.channelName},I=O.reducer,S=n(24),w=S.a.initializeApp({apiKey:"AIzaSyB05OmarqivGc5YTKUATgzXJ8Nz_IOuv9M",authDomain:"discord-clone-75157.firebaseapp.com",projectId:"discord-clone-75157",storageBucket:"discord-clone-75157.appspot.com",messagingSenderId:"538671599107",appId:"1:538671599107:web:1fe145eaebf8df167f8836",measurementId:"G-XDTQKXKTD7"}).firestore(),k=S.a.auth(),C=new S.a.auth.GoogleAuthProvider,T=w;var z=function(e){var a=e.serverId,n=e.serverName,t=e.photo,c=e.channels,r=e.setChannels,i=(Object(o.c)(h),Object(o.b)());return Object(s.jsx)("div",{className:"sidebar__server",onClick:function(){i(v({serverId:a,serverName:n})),T.collection("servers/"+a+"/channels").orderBy("channelName","asc").onSnapshot((function(e){return r(e.docs.map((function(e){return{id:e.id,channel:e.data()}})))})),console.log(c)},children:Object(s.jsx)("img",{id:a,name:n,src:t||"",className:"sidebar__serverImg"})})},E=(n(87),n(46)),F=n.n(E),B=n(45),H=n.n(B);n(88);var D=function(e){var a=e.id,n=e.channelName,t=Object(o.b)();return Object(s.jsx)("div",{className:"sidebarChannel",onClick:function(){return t(x({channelId:a,channelName:n}))},children:Object(s.jsxs)("h4",{children:[Object(s.jsx)("span",{className:"sidebarChannel__hash",children:"#"}),n]})})},L=n(126),A=n(56),M=n.n(A),U=n(128),V=n(55),R=n.n(V),K=n(59),G=n.n(K),J=n(58),W=n.n(J),X=n(57),P=n.n(X);var q=function(){var e=Object(o.c)(h),a=Object(t.useState)([]),n=Object(l.a)(a,2),c=n[0],r=n[1],i=Object(t.useState)([]),d=Object(l.a)(i,2),j=d[0],u=d[1],m=Object(o.c)(g),b=Object(o.c)(_);return Object(t.useEffect)((function(){T.collection("servers").orderBy("serverName","asc").onSnapshot((function(e){return u(e.docs.map((function(e){return{id:e.id,server:e.data()}})))}))}),[]),Object(s.jsxs)("div",{className:"sidebar__panel",children:[Object(s.jsxs)("div",{className:"sidebar__serverList",children:[j.map((function(e){return Object(s.jsx)(z,{serverId:e.id,serverName:e.server.serverName,photo:e.server.photo,channels:c,setChannels:r})})),Object(s.jsx)(H.a,{onClick:function(){var a=prompt("Enter a new server");if(a){var n=prompt("Enter photo URL");n&&T.collection("servers").add({serverName:a,photo:n,administrators:[{displayName:e.displayName,uid:e.uid}],moderators:[]})}},className:"sidebar__addServer"})]}),Object(s.jsxs)("div",{className:"sidebar",children:[Object(s.jsxs)("div",{className:"sidebar__top",children:[Object(s.jsx)("h4",{children:b}),Object(s.jsx)(F.a,{})]}),Object(s.jsxs)("div",{className:"sidebar__channels",children:[Object(s.jsxs)("div",{className:"sidebar__channelsHeader",children:[Object(s.jsxs)("div",{className:"sidebar__header",children:[Object(s.jsx)(F.a,{}),Object(s.jsx)("h4",{children:"Text Channels"})]}),Object(s.jsx)(H.a,{onClick:function(){var e=prompt("Enter a new channel");m&&e&&T.collection("servers/"+m+"/channels").add({channelName:e})},className:"sidebar__addChannel"})]}),Object(s.jsx)("div",{className:"sidebar__channelsList",children:c.map((function(e){var a=e.id,n=e.channel;return Object(s.jsx)(D,{id:a,channelName:n.channelName},a)}))})]}),Object(s.jsxs)("div",{className:"sidebar__voice",children:[Object(s.jsx)(L.a,{className:"sidebar__voiceIcon",fontSize:"initial"}),Object(s.jsxs)("div",{className:"sidebar__voiceInfo",children:[Object(s.jsx)("h3",{children:"Voice Connected"}),Object(s.jsx)("p",{children:"Stream"})]}),Object(s.jsxs)("div",{className:"sidebar__voiceIcons",children:[Object(s.jsx)(R.a,{}),Object(s.jsx)(M.a,{})]})]}),Object(s.jsxs)("div",{className:"sidebar__profile",children:[Object(s.jsx)(U.a,{id:"sidebar__avatar",onClick:function(){return k.signOut()},src:e.photo}),Object(s.jsxs)("div",{className:"sidebar__profileInfo",children:[Object(s.jsx)("h3",{children:e.displayName}),Object(s.jsxs)("p",{children:["#",e.uid.substring(0,10)]})]}),Object(s.jsxs)("div",{className:"sidebar__profileIcons",children:[Object(s.jsx)(P.a,{}),Object(s.jsx)(W.a,{}),Object(s.jsx)(G.a,{})]})]})]})]})},Q=n(27),Y=n.n(Q),$=n(41),Z=n(47),ee=n.n(Z);n(103);var ae=function(e){var a=e.timestamp,n=e.message,t=e.user,c=e.file,r=e.fileType;return Object(s.jsxs)("div",{className:"message",children:[Object(s.jsx)(U.a,{className:"message__avatar",src:t.photo}),Object(s.jsxs)("div",{className:"message__info",children:[Object(s.jsxs)("h4",{children:[t.displayName,Object(s.jsx)("span",{className:"message__timestamp",children:new Date(null===a||void 0===a?void 0:a.toDate()).toUTCString()})]}),Object(s.jsxs)("p",{children:[Object(s.jsx)(ee.a,{properties:{target:"_blank",url:ee.a.MATCH},children:n}),console.log("not defined")]}),function(){var e=null;if(c)switch(r){case"image/apng":case"image/avif":case"image/bmp":case"image/gif":case"image/jpeg":case"image/png":case"image/svg+xml":case"image/webp":case"image/x-icon":e=Object(s.jsx)("img",{src:c,className:"attached__media message__attachment"});break;case"audio/mpeg":case"audio/ogg":case"audio/wav":e=Object(s.jsxs)("audio",{controls:!0,className:"message__attachment",children:[Object(s.jsx)("source",{src:c}),"Audio tag unsupported"]});break;case"video/mp4":case"video/ogg":case"video/webm":e=Object(s.jsx)("video",{controls:!0,src:c,className:"attached__media message__attachment"});break;default:e=Object(s.jsx)("a",{href:c,target:"_blank",children:c})}return e}()]})]})},ne=(n(104),n(60)),se=n.n(ne),te=n(61),ce=n.n(te),re=n(62),ie=n.n(re),le=n(63),oe=n.n(le),de=n(64),je=n.n(de),ue=n(65),me=n.n(ue);var be=function(e){var a=e.channelName;return Object(s.jsxs)("div",{className:"chatHeader",children:[Object(s.jsx)("div",{className:"chatHeader__left",children:Object(s.jsxs)("h3",{children:[Object(s.jsx)("span",{className:"chatHeader__hash",children:"#"}),a]})}),Object(s.jsxs)("div",{className:"chatHeader__right",children:[Object(s.jsx)(se.a,{}),Object(s.jsx)(ce.a,{}),Object(s.jsx)(ie.a,{}),Object(s.jsxs)("div",{className:"chatHeader__search",children:[Object(s.jsx)("input",{placeholder:"Search"}),Object(s.jsx)(oe.a,{})]}),Object(s.jsx)(je.a,{}),Object(s.jsx)(me.a,{})]})]})},he=n(66),pe=n.n(he),Oe=(n(105),n(68)),fe=n.n(Oe),ve=n(69),xe=n.n(ve),ge=n(70),_e=n.n(ge),Ne=n(67),ye=n.n(Ne);var Ie=function(){var e=Object(t.useRef)(),a=Object(o.c)(h),n=Object(o.c)(g),r=Object(o.c)(N),i=Object(o.c)(y),d=Object(t.useState)((function(){return""})),j=Object(l.a)(d,2),u=j[0],m=j[1],b=Object(t.useState)((function(){return[]})),p=Object(l.a)(b,2),O=p[0],f=p[1],v=Object(t.useState)(null),x=Object(l.a)(v,2),_=x[0],I=x[1],w=Object(t.useState)((function(){return null})),k=Object(l.a)(w,2),C=k[0],z=k[1],E=Object(t.useState)((function(){return"none"})),F=Object(l.a)(E,2),B=F[0],H=F[1],D=S.a.storage().ref();return Object(t.useEffect)((function(){r&&(T.collection("servers/"+n+"/channels").doc(r).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){return f(e.docs.map((function(e){return e.data()})))})),e.current.scrollIntoView({behavior:"smooth"}))}),[r]),Object(s.jsxs)("div",{className:"chat",children:[Object(s.jsx)(be,{channelName:i}),Object(s.jsxs)("div",{className:"chat__messages",children:[O.map((function(e){return Object(s.jsx)(ae,{timestamp:e.timestamp,message:e.message,user:e.user,file:e.file,fileType:e.fileType})})),Object(s.jsx)("div",{ref:e})]}),Object(s.jsx)("div",{id:"emoji_picker",style:{display:B},children:Object(s.jsx)(pe.a,{onEmojiClick:function(e,a){m(u+a.emoji)}})}),Object(s.jsxs)("div",{className:"chat__input",children:[Object(s.jsx)("input",{type:"file",id:"att_file",name:"att_file",accept:"image/x-png,image/gif,image/jpeg,image/bmp,audio/mpeg",disabled:!r,files:_,value:function(){return _?_.name:""},onChange:function(e){e.target.files[0]?(I(e.target.files[0]),z(e.target.files[0].name)):console.log("File action cancelled")}}),c.a.createElement("label",{htmlFor:"att_file"},Object(s.jsx)(ye.a,{fontSize:"large"})),Object(s.jsxs)("form",{children:[Object(s.jsx)("input",{value:u,disabled:!r,onChange:function(e){return m(e.target.value)},placeholder:C||"#Message "+i}),Object(s.jsx)("button",{disabled:!r,className:"chat__inputButton",type:"submit",onClick:function(s){s.preventDefault();var t=null,c=null;if(_){var i=function(){var e=Object($.a)(Y.a.mark((function e(s){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=T.collection("servers/"+n+"/channels").doc(r).collection("messages"),e.t1=S.a.firestore.FieldValue.serverTimestamp(),e.t2=u,e.t3=a,e.next=6,s;case 6:e.t4=e.sent,e.t5=_.type,e.t6={timestamp:e.t1,message:e.t2,user:e.t3,file:e.t4,fileType:e.t5},e.t0.add.call(e.t0,e.t6),I(null);case 11:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();if(_.size>2097152)alert("File is over 2MB limit!"),I(null);else{D.child(a.displayName+"-"+_.name).getDownloadURL().then(i,(function(){t=D.child(a.displayName+"-"+_.name),console.log(_.size),t.put(_).then(Object($.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDownloadURL();case 2:c=e.sent,console.log("File has been uploaded");case 4:case"end":return e.stop()}}),e)})))).then(Object($.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.collection("servers/"+n+"/channels").doc(r).collection("messages").add({timestamp:S.a.firestore.FieldValue.serverTimestamp(),message:u,user:a,file:c,fileType:_.type});case 2:case"end":return e.stop()}}),e)})))).then((function(){I(null)}))}))}}else!_&&u&&""!=u.split(" ").join("")&&(T.collection("servers/"+n+"/channels").doc(r).collection("messages").add({timestamp:S.a.firestore.FieldValue.serverTimestamp(),message:u,user:a,file:null}),I(null));m(""),z(null),e.current.scrollIntoView({behavior:"smooth"})},children:"Send Message"})]}),Object(s.jsxs)("div",{className:"chat__inputIcons",children:[Object(s.jsx)(fe.a,{fontSize:"large"}),Object(s.jsx)(xe.a,{fontSize:"large"}),Object(s.jsx)(_e.a,{onClick:function(){H(r&&"none"==B?"flex":"none")},fontSize:"large"})]})]})]})},Se=n(127);n(106);var we=function(){return Object(s.jsxs)("div",{className:"login",children:[Object(s.jsx)("div",{className:"login__logo",children:Object(s.jsx)("img",{src:"/main_logo.png",alt:"app logo"})}),Object(s.jsx)(Se.a,{onClick:function(){k.signInWithPopup(C).catch((function(e){return alert(e.message)}))},children:"Sign In"})]})};n(107);var ke=function(e){var a=e.displayState,n=e.displayHook,t=e.content;return Object(s.jsx)("div",{className:"modal",style:{display:a},children:Object(s.jsxs)("div",{className:"modal__content",children:[Object(s.jsx)("span",{type:"button",className:"modal__close",onClick:function(){n("none")},children:"\u2573"}),t]})})};n(108);var Ce=function(){return Object(s.jsxs)("div",{className:"members",children:[Object(s.jsx)("div",{className:"members__list",children:Object(s.jsx)("p",{children:"ONLINE"})}),Object(s.jsx)("div",{className:"members__list",children:Object(s.jsx)("p",{children:"OFFLINE"})})]})};var Te=function(){var e=Object(o.b)(),a=Object(o.c)(h),n=Object(t.useState)("none"),c=Object(l.a)(n,2),r=c[0],i=c[1];return Object(t.useEffect)((function(){k.onAuthStateChanged((function(a){e(a?m({uid:a.uid,photo:a.photoURL,email:a.email,displayName:a.displayName}):b())}))}),[e]),Object(s.jsx)("div",{className:"app",children:a?Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(q,{}),Object(s.jsx)(Ie,{}),Object(s.jsx)(Ce,{}),Object(s.jsx)(ke,{displayState:r,displayHook:i})]}):Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(we,{})})})},ze=Object(d.a)({reducer:{user:p,app:I}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(s.jsx)(c.a.StrictMode,{children:Object(s.jsx)(o.a,{store:ze,children:Object(s.jsx)(Te,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},78:function(e,a,n){},79:function(e,a,n){},83:function(e,a,n){},87:function(e,a,n){},88:function(e,a,n){}},[[109,1,2]]]);
//# sourceMappingURL=main.08a1b987.chunk.js.map