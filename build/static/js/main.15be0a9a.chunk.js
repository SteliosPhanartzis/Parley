(this["webpackJsonpdiscord-clone"]=this["webpackJsonpdiscord-clone"]||[]).push([[0],{103:function(e,a,t){},104:function(e,a,t){},105:function(e,a,t){},106:function(e,a,t){},107:function(e,a,t){},108:function(e,a,t){},109:function(e,a,t){"use strict";t.r(a);var n=t(3),s=t(2),c=t.n(s),r=t(26),i=t.n(r),l=(t(78),t(24)),o=t.n(l),d=t(31),u=t(16),j=(t(80),t(9)),m=t(29),b=Object(m.b)({name:"user",initialState:{user:null},reducers:{login:function(e,a){e.user=a.payload},logout:function(e){e.user=null}}}),h=b.actions,p=h.login,f=h.logout,O=function(e){return e.user.user},v=b.reducer,x=(t(84),Object(m.b)({name:"app",initialState:{serverId:null,serverName:null,channelId:null,channelName:null,membersList:[]},reducers:{setServerInfo:function(e,a){e.serverId=a.payload.serverId,e.serverName=a.payload.serverName,e.channelId=null,e.channelName=null},setChannelInfo:function(e,a){e.channelId=a.payload.channelId,e.channelName=a.payload.channelName},setMembersList:function(e,a){e.membersList+=a.payload.membersList}}})),g=x.actions,_=g.setServerInfo,N=g.setChannelInfo,y=(g.setMembersList,function(e){return e.app.serverId}),S=function(e){return e.app.serverName},I=function(e){return e.app.channelId},w=function(e){return e.app.channelName},k=x.reducer,C=t(23),T=C.a.initializeApp({apiKey:"AIzaSyB05OmarqivGc5YTKUATgzXJ8Nz_IOuv9M",authDomain:"discord-clone-75157.firebaseapp.com",projectId:"discord-clone-75157",storageBucket:"discord-clone-75157.appspot.com",messagingSenderId:"538671599107",appId:"1:538671599107:web:1fe145eaebf8df167f8836",measurementId:"G-XDTQKXKTD7"}).firestore(),E=C.a.auth(),z=new C.a.auth.GoogleAuthProvider,L=T;var B=function(e){var a=e.serverId,t=e.serverName,s=e.photo,c=e.channels,r=e.setChannels,i=(Object(j.c)(O),Object(j.b)());return Object(n.jsx)("div",{className:"sidebar__server",onClick:function(){i(_({serverId:a,serverName:t})),L.collection("servers/"+a+"/channels").orderBy("channelName","asc").onSnapshot((function(e){return r(e.docs.map((function(e){return{id:e.id,channel:e.data()}})))})),console.log(c)},children:Object(n.jsx)("img",{id:a,name:t,src:s||"",className:"sidebar__serverImg"})},a)},F=(t(88),t(47)),H=t.n(F),D=t(46),M=t.n(D);t(89);var U=function(e){var a=e.id,t=e.channelName,s=Object(j.b)();return Object(n.jsx)("div",{className:"sidebarChannel",onClick:function(){return s(N({channelId:a,channelName:t}))},children:Object(n.jsxs)("h4",{children:[Object(n.jsx)("span",{className:"sidebarChannel__hash",children:"#"}),t]})},a)},A=t(126),R=t(56),V=t.n(R),K=t(128),P=t(55),G=t.n(P),J=t(59),W=t.n(J),X=t(58),q=t.n(X),Q=t(57),Y=t.n(Q);var $=function(){var e=Object(j.c)(O),a=Object(s.useState)([]),t=Object(u.a)(a,2),c=t[0],r=t[1],i=Object(s.useState)([]),l=Object(u.a)(i,2),o=l[0],d=l[1],m=Object(j.c)(y),b=Object(j.c)(S),h=L.collection("users");return Object(s.useEffect)((function(){L.collection("servers").orderBy("serverName","asc").onSnapshot((function(e){return d(e.docs.map((function(e){return{id:e.id,server:e.data()}})))}))}),[]),Object(n.jsxs)("div",{className:"sidebar__panel",children:[Object(n.jsxs)("div",{className:"sidebar__serverList",children:[o.map((function(e){return Object(n.jsx)(B,{serverId:e.id,serverName:e.server.serverName,photo:e.server.photo,channels:c,setChannels:r})})),Object(n.jsx)(M.a,{onClick:function(){var a=prompt("Enter a new server");if(a){var t=prompt("Enter photo URL");t&&L.collection("servers").add({serverName:a,photo:t,administrators:[{displayName:e.displayName,uid:e.uid}],moderators:[]})}},className:"sidebar__addServer"})]}),Object(n.jsxs)("div",{className:"sidebar",children:[Object(n.jsxs)("div",{className:"sidebar__top",children:[Object(n.jsx)("h4",{children:b}),Object(n.jsx)(H.a,{})]}),Object(n.jsxs)("div",{className:"sidebar__channels",children:[Object(n.jsxs)("div",{className:"sidebar__channelsHeader",children:[Object(n.jsxs)("div",{className:"sidebar__header",children:[Object(n.jsx)(H.a,{}),Object(n.jsx)("h4",{children:"Text Channels"})]}),Object(n.jsx)(M.a,{onClick:function(){var e=prompt("Enter a new channel");m&&e&&L.collection("servers/"+m+"/channels").add({channelName:e})},className:"sidebar__addChannel"})]}),Object(n.jsx)("div",{className:"sidebar__channelsList",children:c.map((function(e){var a=e.id,t=e.channel;return Object(n.jsx)(U,{id:a,channelName:t.channelName},a)}))})]}),Object(n.jsxs)("div",{className:"sidebar__voice",children:[Object(n.jsx)(A.a,{className:"sidebar__voiceIcon",fontSize:"initial"}),Object(n.jsxs)("div",{className:"sidebar__voiceInfo",children:[Object(n.jsx)("h3",{children:"Voice Connected"}),Object(n.jsx)("p",{children:"Stream"})]}),Object(n.jsxs)("div",{className:"sidebar__voiceIcons",children:[Object(n.jsx)(G.a,{}),Object(n.jsx)(V.a,{})]})]}),Object(n.jsxs)("div",{className:"sidebar__profile",children:[Object(n.jsx)(K.a,{id:"sidebar__avatar",onClick:function(){h.where("uid","==",e.uid).limit(1).get().then((function(e){e.forEach((function(e){h.doc(e.id).update({status:"offline"})}))})),E.signOut()},src:e.photo}),Object(n.jsxs)("div",{className:"sidebar__profileInfo",children:[Object(n.jsx)("h3",{children:e.displayName}),Object(n.jsxs)("p",{children:["#",e.uid.substring(0,10)]})]}),Object(n.jsxs)("div",{className:"sidebar__profileIcons",children:[Object(n.jsx)(Y.a,{}),Object(n.jsx)(q.a,{}),Object(n.jsx)(W.a,{})]})]})]})]})},Z=t(48),ee=t.n(Z);t(103);var ae=function(e){var a=e.timestamp,t=e.message,s=e.user,c=e.file,r=e.fileType;return Object(n.jsxs)("div",{className:"message",children:[Object(n.jsx)(K.a,{className:"message__avatar",src:s.photo}),Object(n.jsxs)("div",{className:"message__info",children:[Object(n.jsxs)("h4",{children:[s.displayName,Object(n.jsx)("span",{className:"message__timestamp",children:new Date(null===a||void 0===a?void 0:a.toDate()).toUTCString()})]}),Object(n.jsxs)("p",{children:[Object(n.jsx)(ee.a,{properties:{target:"_blank",url:ee.a.MATCH},children:t}),console.log("not defined")]}),function(){var e=null;if(c)switch(r){case"image/apng":case"image/avif":case"image/bmp":case"image/gif":case"image/jpeg":case"image/png":case"image/svg+xml":case"image/webp":case"image/x-icon":e=Object(n.jsx)("img",{src:c,className:"attached__media message__attachment"});break;case"audio/mpeg":case"audio/ogg":case"audio/wav":e=Object(n.jsxs)("audio",{controls:!0,className:"message__attachment",children:[Object(n.jsx)("source",{src:c}),"Audio tag unsupported"]});break;case"video/mp4":case"video/ogg":case"video/webm":e=Object(n.jsx)("video",{controls:!0,src:c,className:"attached__media message__attachment"});break;default:e=Object(n.jsx)("a",{href:c,target:"_blank",children:c})}return e}()]})]})},te=(t(104),t(60)),ne=t.n(te),se=t(61),ce=t.n(se),re=t(62),ie=t.n(re),le=t(63),oe=t.n(le),de=t(64),ue=t.n(de),je=t(65),me=t.n(je);var be=function(e){var a=e.channelName;return Object(n.jsxs)("div",{className:"chatHeader",children:[Object(n.jsx)("div",{className:"chatHeader__left",children:Object(n.jsxs)("h3",{children:[Object(n.jsx)("span",{className:"chatHeader__hash",children:"#"}),a]})}),Object(n.jsxs)("div",{className:"chatHeader__right",children:[Object(n.jsx)(ne.a,{}),Object(n.jsx)(ce.a,{}),Object(n.jsx)(ie.a,{}),Object(n.jsxs)("div",{className:"chatHeader__search",children:[Object(n.jsx)("input",{placeholder:"Search"}),Object(n.jsx)(oe.a,{})]}),Object(n.jsx)(ue.a,{}),Object(n.jsx)("a",{href:"https://github.com/SteliosPhanartzis/Parley",children:Object(n.jsx)(me.a,{})})]})]})},he=t(66),pe=t.n(he),fe=(t(105),t(68)),Oe=t.n(fe),ve=t(69),xe=t.n(ve),ge=t(70),_e=t.n(ge),Ne=t(67),ye=t.n(Ne);var Se=function(){var e=Object(s.useRef)(),a=Object(j.c)(O),t=Object(j.c)(y),r=Object(j.c)(I),i=Object(j.c)(w),l=Object(s.useState)((function(){return""})),m=Object(u.a)(l,2),b=m[0],h=m[1],p=Object(s.useState)((function(){return[]})),f=Object(u.a)(p,2),v=f[0],x=f[1],g=Object(s.useState)(null),_=Object(u.a)(g,2),N=_[0],S=_[1],k=Object(s.useState)((function(){return null})),T=Object(u.a)(k,2),E=T[0],z=T[1],B=Object(s.useState)((function(){return"none"})),F=Object(u.a)(B,2),H=F[0],D=F[1],M=C.a.storage().ref();return Object(s.useEffect)((function(){r&&(L.collection("servers/"+t+"/channels/"+r+"/messages").orderBy("timestamp","asc").onSnapshot((function(e){return x(e.docs.map((function(e){return e.data()})))})),e.current.scrollIntoView({behavior:"smooth"}))}),[r]),Object(n.jsxs)("div",{className:"chat",children:[Object(n.jsx)(be,{channelName:i}),Object(n.jsxs)("div",{className:"chat__messages",children:[v.map((function(e){return Object(n.jsx)(ae,{timestamp:e.timestamp,message:e.message,user:e.user,file:e.file,fileType:e.fileType})})),Object(n.jsx)("div",{ref:e})]}),Object(n.jsx)("div",{id:"emoji_picker",style:{display:H},children:Object(n.jsx)(pe.a,{onEmojiClick:function(e,a){h(b+a.emoji)}})}),Object(n.jsxs)("div",{className:"chat__input",children:[Object(n.jsx)("input",{type:"file",id:"att_file",name:"att_file",accept:"image/x-png,image/gif,image/jpeg,image/bmp,audio/mpeg",disabled:!r,files:N,value:function(){return N?N.name:""},onChange:function(e){e.target.files[0]?(S(e.target.files[0]),z(e.target.files[0].name)):console.log("File action cancelled")}}),c.a.createElement("label",{htmlFor:"att_file"},Object(n.jsx)(ye.a,{fontSize:"large"})),Object(n.jsxs)("form",{children:[Object(n.jsx)("input",{value:b,disabled:!r,onChange:function(e){return h(e.target.value)},placeholder:E||"#Message "+i}),Object(n.jsx)("button",{disabled:!r,className:"chat__inputButton",type:"submit",onClick:function(n){n.preventDefault();var s=null,c=null;if(N){var i=function(){var e=Object(d.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=L.collection("servers/"+t+"/channels").doc(r).collection("messages"),e.t1=C.a.firestore.FieldValue.serverTimestamp(),e.t2=b,e.t3=a,e.next=6,n;case 6:e.t4=e.sent,e.t5=N.type,e.t6={timestamp:e.t1,message:e.t2,user:e.t3,file:e.t4,fileType:e.t5},e.t0.add.call(e.t0,e.t6),S(null);case 11:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();if(N.size>2097152)alert("File is over 2MB limit!"),S(null);else{M.child(a.displayName+"-"+N.name).getDownloadURL().then(i,(function(){s=M.child(a.displayName+"-"+N.name),console.log(N.size),s.put(N).then(Object(d.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.getDownloadURL();case 2:c=e.sent,console.log("File has been uploaded");case 4:case"end":return e.stop()}}),e)})))).then(Object(d.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.collection("servers/"+t+"/channels/"+r+"/messages").add({timestamp:C.a.firestore.FieldValue.serverTimestamp(),message:b,user:a,file:c,fileType:N.type});case 2:case"end":return e.stop()}}),e)})))).then((function(){S(null)}))}))}}else!N&&b&&""!=b.split(" ").join("")&&(L.collection("servers/"+t+"/channels").doc(r).collection("messages").add({timestamp:C.a.firestore.FieldValue.serverTimestamp(),message:b,user:a,file:null}),S(null));h(""),z(null),e.current.scrollIntoView({behavior:"smooth"})},children:"Send Message"})]}),Object(n.jsxs)("div",{className:"chat__inputIcons",children:[Object(n.jsx)(Oe.a,{fontSize:"large"}),Object(n.jsx)(xe.a,{fontSize:"large"}),Object(n.jsx)(_e.a,{onClick:function(){D(r&&"none"==H?"flex":"none")},fontSize:"large"})]})]})]})},Ie=t(127);t(106);var we=function(){return Object(n.jsxs)("div",{className:"login",children:[Object(n.jsx)("div",{className:"login__logo",children:Object(n.jsx)("img",{src:"/main_logo.png",alt:"app logo"})}),Object(n.jsx)(Ie.a,{onClick:function(){E.signInWithPopup(z).catch((function(e){return alert(e.message)}))},children:"Sign In"})]})};t(107);var ke=function(e){var a=e.displayState,t=e.displayHook,s=e.content;return Object(n.jsx)("div",{className:"modal",style:{display:a},children:Object(n.jsxs)("div",{className:"modal__content",children:[Object(n.jsx)("span",{type:"button",className:"modal__close",onClick:function(){t("none")},children:"\u2573"}),s]})})};t(108);var Ce=function(){var e=L.collection("users"),a=Object(s.useState)([]),t=Object(u.a)(a,2),c=t[0],r=t[1];return Object(s.useEffect)((function(){e.onSnapshot((function(e){return r(e.docs.map((function(e){return{id:e.id,user:e.data()}})))}))}),[]),Object(n.jsx)("div",{className:"members",children:Object(n.jsxs)("div",{className:"members__list",children:[Object(n.jsx)("p",{children:"USERS"}),c.map((function(e){return Object(n.jsxs)("div",{className:"online"==e.user.status?"active":"inactive",children:[Object(n.jsx)(K.a,{src:e.user.photo}),Object(n.jsx)("p",{children:e.user.displayName})]},e.user.uid+e.user.status)}))]})})};var Te=function(){var e=Object(j.b)(),a=Object(j.c)(O),t=Object(s.useState)("none"),c=Object(u.a)(t,2),r=c[0],i=c[1];return Object(s.useEffect)((function(){E.onAuthStateChanged(function(){var t=Object(d.a)(o.a.mark((function t(n){var s,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=L.collection("users"),!n){t.next=8;break}return c=s.where("uid","==",n.uid).limit(1).get(),t.next=5,c.then((function(e){console.log(n),0==e.docs.length?s.add({uid:n.uid,displayName:n.displayName,photo:n.photoURL,status:"online"}):e.forEach((function(e){s.doc(e.id).update({status:"online"})}))}));case 5:e(p({uid:n.uid,photo:n.photoURL,email:n.email,displayName:n.displayName})),t.next=11;break;case 8:if(!a){t.next=11;break}return t.next=11,e(f());case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),[e]),Object(n.jsx)("div",{className:"app",children:a?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)($,{}),Object(n.jsx)(Se,{}),Object(n.jsx)(Ce,{}),Object(n.jsx)(ke,{displayState:r,displayHook:i})]}):Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(we,{})})})},Ee=Object(m.a)({reducer:{user:v,app:k}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(j.a,{store:Ee,children:Object(n.jsx)(Te,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},78:function(e,a,t){},80:function(e,a,t){},84:function(e,a,t){},88:function(e,a,t){},89:function(e,a,t){}},[[109,1,2]]]);
//# sourceMappingURL=main.15be0a9a.chunk.js.map