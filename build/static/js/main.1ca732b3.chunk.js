(this["webpackJsonpdiscord-clone"]=this["webpackJsonpdiscord-clone"]||[]).push([[0],{77:function(e,n,a){},78:function(e,n,a){},82:function(e,n,a){},86:function(e,n,a){},87:function(e,n,a){},90:function(e,n,a){},91:function(e,n,a){},92:function(e,n,a){},93:function(e,n,a){},94:function(e,n,a){"use strict";a.r(n);var t=a(3),s=a(2),c=a.n(s),r=a(25),i=a.n(r),l=(a(77),a(78),a(24)),o=a(9),d=a(29),j=Object(d.b)({name:"user",initialState:{user:null},reducers:{login:function(e,n){e.user=n.payload},logout:function(e){e.user=null}}}),u=j.actions,m=u.login,h=u.logout,b=function(e){return e.user.user},p=j.reducer,O=(a(82),Object(d.b)({name:"app",initialState:{serverId:null,serverName:null,channelId:null,channelName:null},reducers:{setServerInfo:function(e,n){e.serverId=n.payload.serverId,e.serverName=n.payload.serverName,e.channelId=null,e.channelName=null},setChannelInfo:function(e,n){e.channelId=n.payload.channelId,e.channelName=n.payload.channelName}}})),f=O.actions,v=f.setServerInfo,x=f.setChannelInfo,g=function(e){return e.app.serverId},_=function(e){return e.app.serverName},N=function(e){return e.app.channelId},I=function(e){return e.app.channelName},y=O.reducer,S=a(23),w=S.a.initializeApp({apiKey:"AIzaSyB05OmarqivGc5YTKUATgzXJ8Nz_IOuv9M",authDomain:"discord-clone-75157.firebaseapp.com",projectId:"discord-clone-75157",storageBucket:"discord-clone-75157.appspot.com",messagingSenderId:"538671599107",appId:"1:538671599107:web:1fe145eaebf8df167f8836",measurementId:"G-XDTQKXKTD7"}).firestore(),C=S.a.auth(),k=new S.a.auth.GoogleAuthProvider,T=w;var z=function(e){var n=e.serverId,a=e.serverName,s=e.photo,c=e.channels,r=e.setChannels,i=(Object(o.c)(b),Object(o.b)());return Object(t.jsx)("div",{className:"sidebar__server",onClick:function(){i(v({serverId:n,serverName:a})),T.collection("servers/"+n+"/channels").orderBy("channelName","asc").onSnapshot((function(e){return r(e.docs.map((function(e){return{id:e.id,channel:e.data()}})))})),console.log(c)},children:Object(t.jsx)("img",{id:n,name:a,src:s||"",className:"sidebar__serverImg"})})},E=(a(86),a(46)),B=a.n(E),D=a(45),F=a.n(D);a(87);var A=function(e){var n=e.id,a=e.channelName,s=Object(o.b)();return Object(t.jsx)("div",{className:"sidebarChannel",onClick:function(){return s(x({channelId:n,channelName:a}))},children:Object(t.jsxs)("h4",{children:[Object(t.jsx)("span",{className:"sidebarChannel__hash",children:"#"}),a]})})},H=a(111),L=a(55),U=a.n(L),V=a(113),R=a(54),K=a.n(R),M=a(58),G=a.n(M),J=a(57),W=a.n(J),X=a(56),P=a.n(X);var q=function(){var e=Object(o.c)(b),n=Object(s.useState)([]),a=Object(l.a)(n,2),c=a[0],r=a[1],i=Object(s.useState)([]),d=Object(l.a)(i,2),j=d[0],u=d[1],m=Object(o.c)(g),h=Object(o.c)(_);return Object(s.useEffect)((function(){T.collection("servers").orderBy("serverName","asc").onSnapshot((function(e){return u(e.docs.map((function(e){return{id:e.id,server:e.data()}})))}))}),[]),Object(t.jsxs)(t.Fragment,{children:[Object(t.jsxs)("div",{className:"sidebar__serverList",children:[j.map((function(e){return Object(t.jsx)(z,{serverId:e.id,serverName:e.server.serverName,photo:e.server.photo,channels:c,setChannels:r})})),Object(t.jsx)(F.a,{onClick:function(){var n=prompt("Enter a new server");if(n){var a=prompt("Enter photo URL");a&&T.collection("servers").add({serverName:n,photo:a,administrators:[{displayName:e.displayName,uid:e.uid}],moderators:[]})}},className:"sidebar__addServer"})]}),Object(t.jsxs)("div",{className:"sidebar",children:[Object(t.jsxs)("div",{className:"sidebar__top",children:[Object(t.jsx)("h3",{children:h}),Object(t.jsx)(B.a,{})]}),Object(t.jsxs)("div",{className:"sidebar__channels",children:[Object(t.jsxs)("div",{className:"sidebar__channelsHeader",children:[Object(t.jsxs)("div",{className:"sidebar__header",children:[Object(t.jsx)(B.a,{}),Object(t.jsx)("h4",{children:"Text Channels"})]}),Object(t.jsx)(F.a,{onClick:function(){var e=prompt("Enter a new channel");m&&e&&T.collection("servers/"+m+"/channels").add({channelName:e})},className:"sidebar__addChannel"})]}),Object(t.jsx)("div",{className:"sidebar__channelsList",children:c.map((function(e){var n=e.id,a=e.channel;return Object(t.jsx)(A,{id:n,channelName:a.channelName},n)}))})]}),Object(t.jsxs)("div",{className:"sidebar__voice",children:[Object(t.jsx)(H.a,{className:"sidebar__voiceIcon",fontSize:"large"}),Object(t.jsxs)("div",{className:"sidebar__voiceInfo",children:[Object(t.jsx)("h3",{children:"Voice Connected"}),Object(t.jsx)("p",{children:"Stream"})]}),Object(t.jsxs)("div",{className:"sidebar__voiceIcons",children:[Object(t.jsx)(K.a,{}),Object(t.jsx)(U.a,{})]})]}),Object(t.jsxs)("div",{className:"sidebar__profile",children:[Object(t.jsx)(V.a,{onClick:function(){return C.signOut()},src:e.photo}),Object(t.jsxs)("div",{className:"sidebar__profileInfo",children:[Object(t.jsx)("h3",{children:e.displayName}),Object(t.jsxs)("p",{children:["#",e.uid.substring(0,10)]})]}),Object(t.jsxs)("div",{className:"sidebar__profileIcons",children:[Object(t.jsx)(P.a,{}),Object(t.jsx)(W.a,{}),Object(t.jsx)(G.a,{})]})]})]})]})},Q=a(27),Y=a.n(Q),$=a(41);a(90);var Z=function(e){var n=e.timestamp,a=e.message,s=e.user,c=e.file,r=e.fileType;return Object(t.jsxs)("div",{className:"message",children:[Object(t.jsx)(V.a,{className:"message__avatar",src:s.photo}),Object(t.jsxs)("div",{className:"message__info",children:[Object(t.jsxs)("h4",{children:[s.displayName,Object(t.jsx)("span",{className:"message__timestamp",children:new Date(null===n||void 0===n?void 0:n.toDate()).toUTCString()})]}),Object(t.jsx)("p",{children:a}),function(){var e=null;if(c)switch(r){case"image/bmp":case"image/gif":case"image/jpeg":case"image/png":e=Object(t.jsx)("img",{src:c,className:"attached__image message__attachment"});break;case"audio/mpeg":e=Object(t.jsxs)("audio",{className:"message__attachment",controls:!0,children:[Object(t.jsx)("source",{src:c}),"Audio tag unsupported"]})}return e}()]})]})},ee=(a(91),a(59)),ne=a.n(ee),ae=a(60),te=a.n(ae),se=a(61),ce=a.n(se),re=a(62),ie=a.n(re),le=a(63),oe=a.n(le),de=a(64),je=a.n(de);var ue=function(e){var n=e.channelName;return Object(t.jsxs)("div",{className:"chatHeader",children:[Object(t.jsx)("div",{className:"chatHeader__left",children:Object(t.jsxs)("h3",{children:[Object(t.jsx)("span",{className:"chatHeader__hash",children:"#"}),n]})}),Object(t.jsxs)("div",{className:"chatHeader__right",children:[Object(t.jsx)(ne.a,{}),Object(t.jsx)(te.a,{}),Object(t.jsx)(ce.a,{}),Object(t.jsxs)("div",{className:"chatHeader__search",children:[Object(t.jsx)("input",{placeholder:"Search"}),Object(t.jsx)(ie.a,{})]}),Object(t.jsx)(oe.a,{}),Object(t.jsx)(je.a,{})]})]})},me=a(65),he=a.n(me),be=(a(92),a(67)),pe=a.n(be),Oe=a(68),fe=a.n(Oe),ve=a(69),xe=a.n(ve),ge=a(66),_e=a.n(ge);var Ne=function(){var e=Object(s.useRef)(),n=Object(o.c)(b),a=Object(o.c)(g),r=Object(o.c)(N),i=Object(o.c)(I),d=Object(s.useState)(""),j=Object(l.a)(d,2),u=j[0],m=j[1],h=Object(s.useState)([]),p=Object(l.a)(h,2),O=p[0],f=p[1],v=Object(s.useState)(null),x=Object(l.a)(v,2),_=x[0],y=x[1],w=Object(s.useState)(null),C=Object(l.a)(w,2),k=C[0],z=C[1],E=Object(s.useState)("none"),B=Object(l.a)(E,2),D=B[0],F=B[1],A=S.a.storage().ref();return Object(s.useEffect)((function(){r&&(T.collection("servers/"+a+"/channels").doc(r).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){return f(e.docs.map((function(e){return e.data()})))})),e.current.scrollIntoView({behavior:"smooth"}))}),[r]),Object(t.jsxs)("div",{className:"chat",children:[Object(t.jsx)(ue,{channelName:i}),Object(t.jsxs)("div",{className:"chat__messages",children:[O.map((function(e){return Object(t.jsx)(Z,{timestamp:e.timestamp,message:e.message,user:e.user,file:e.file,fileType:e.fileType})})),Object(t.jsx)("div",{ref:e})]}),Object(t.jsx)("div",{id:"emoji_picker",style:{display:D},children:Object(t.jsx)(he.a,{onEmojiClick:function(e,n){m(u+n.emoji)}})}),Object(t.jsxs)("div",{className:"chat__input",children:[Object(t.jsx)("input",{type:"file",id:"att_file",name:"att_file",accept:"image/x-png,image/gif,image/jpeg",disabled:!r,files:_,onChange:function(e){y(e.target.files[0]),z(e.target.files[0].name)}}),c.a.createElement("label",{htmlFor:"att_file"},Object(t.jsx)(_e.a,{fontSize:"large"})),Object(t.jsxs)("form",{children:[Object(t.jsx)("input",{value:u,disabled:!r,onChange:function(e){return m(e.target.value)},placeholder:k||"#Message "+i}),Object(t.jsx)("button",{disabled:!r,className:"chat__inputButton",type:"submit",onClick:function(t){t.preventDefault();var s=null,c=null;if(_){var i=function(){var e=Object($.a)(Y.a.mark((function e(t){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=T.collection("servers/"+a+"/channels").doc(r).collection("messages"),e.t1=S.a.firestore.FieldValue.serverTimestamp(),e.t2=u,e.t3=n,e.next=6,t;case 6:e.t4=e.sent,e.t5=_.type,e.t6={timestamp:e.t1,message:e.t2,user:e.t3,file:e.t4,fileType:e.t5},e.t0.add.call(e.t0,e.t6),y(null);case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();A.child(n.displayName+"-"+_.name).getDownloadURL().then(i,(function(){(s=A.child(n.displayName+"-"+_.name)).put(_).then(Object($.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.getDownloadURL();case 2:c=e.sent,console.log("File has been uploaded");case 4:case"end":return e.stop()}}),e)})))).then(Object($.a)(Y.a.mark((function e(){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.collection("servers/"+a+"/channels").doc(r).collection("messages").add({timestamp:S.a.firestore.FieldValue.serverTimestamp(),message:u,user:n,file:c,fileType:_.type});case 2:case"end":return e.stop()}}),e)})))).then((function(){y(null)}))}))}else!_&&u&&""!=u.split(" ").join("")&&(T.collection("servers/"+a+"/channels").doc(r).collection("messages").add({timestamp:S.a.firestore.FieldValue.serverTimestamp(),message:u,user:n,file:null}),y(null));m(""),z(null),e.current.scrollIntoView({behavior:"smooth"})},children:"Send Message"})]}),Object(t.jsxs)("div",{className:"chat__inputIcons",children:[Object(t.jsx)(pe.a,{fontSize:"large"}),Object(t.jsx)(fe.a,{fontSize:"large"}),Object(t.jsx)(xe.a,{onClick:function(){F(r&&"none"==D?"flex":"none")},fontSize:"large"})]})]})]})},Ie=a(112);a(93);var ye=function(){return Object(t.jsxs)("div",{className:"login",children:[Object(t.jsx)("div",{className:"login__logo",children:Object(t.jsx)("img",{src:"/main_logo.png",alt:"app logo"})}),Object(t.jsx)(Ie.a,{onClick:function(){C.signInWithPopup(k).catch((function(e){return alert(e.message)}))},children:"Sign In"})]})};var Se=function(){var e=Object(o.b)(),n=Object(o.c)(b);return Object(s.useEffect)((function(){C.onAuthStateChanged((function(n){e(n?m({uid:n.uid,photo:n.photoURL,email:n.email,displayName:n.displayName}):h())}))}),[e]),Object(t.jsx)("div",{className:"app",children:n?Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(q,{}),Object(t.jsx)(Ne,{})]}):Object(t.jsx)(t.Fragment,{children:Object(t.jsx)(ye,{})})})},we=Object(d.a)({reducer:{user:p,app:y}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(t.jsx)(c.a.StrictMode,{children:Object(t.jsx)(o.a,{store:we,children:Object(t.jsx)(Se,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[94,1,2]]]);
//# sourceMappingURL=main.1ca732b3.chunk.js.map